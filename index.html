<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, height=device-height, user-scalable=no">
    <link rel="stylesheet" type="text/css" href="StyleSheet.css">
    <script>
        window.addEventListener('load', function () {
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('./sw.js').then(function (registration) {
                });
            }
        });
    </script>
</head>

<body ondrop="onDrop(event);" ondragover="onDragOver(event);">
    <label>色<input id="color" type="color"></label>
    <label>太さ<input id="width" type="number" min="1" max="30"></label>
    <input type="image" id="scroll" src="scroll.png" width="20" class="active" onClick="tool(1)">
    <input type="image" id="pencil" src="1.png" width="20" onClick="tool(2)">
    <input type="image" id="eraser" src="2.png" width="20" onClick="tool(3)">
    <input type="image" id="sentaku" src="3.jpg" width="20" onClick="tool(4)">
    <button id="delbt">クリア</button><button id="savebt">保存</button><button id="send">提出</button>
    <form>
        <input type='file' accept='image/*' multiple='multiple' name='imgs[]'>
        <button type='submit'>送信</button>
    </form>

    <br />
    <canvas id="canvas"></canvas>
    <canvas id="RecCanvas"></canvas>
    <script src="Script1229.js"></script>

    <a href='https://ktr003.github.io/note2348.github.io/#&togetherjs=kqyhLSd8TK' target="_blank">ログイン</a>
    <script src="https://togetherjs.com/togetherjs-min.js"></script>

    <script src='https://www.gstatic.com/firebasejs/7.5.0/firebase-app.js'></script>
    <script src='https://www.gstatic.com/firebasejs/7.5.0/firebase-storage.js'></script>
    <script>
        //firebase初期化
        const firebaseConfig = {
            apiKey: "AIzaSyDtDj9LnJFA7Vct4JbAbqidNg1BsSq8YNY",
            authDomain: "noteapp-1229.firebaseapp.com",
            projectId: "noteapp-1229",
            storageBucket: "noteapp-1229.appspot.com",
            messagingSenderId: "330140971770",
            appId: "1:330140971770:web:3760d22c8f5ff8c23d8f43",
            measurementId: "G-5WMTW9TM22"
        };
        firebase.initializeApp(firebaseConfig);

        //formのsubmitにイベント設定
        var form = document.querySelector('form');
        form.addEventListener('submit', function (e) {
            e.preventDefault();
            var imgs = form.querySelector('input');
            var uploads = [];
            for (var file of imgs.files) {
                var storageRef = firebase.storage().ref('report-uploaded/' + file.name);
                uploads.push(storageRef.put(file));

            }
            //すべての画像のアップロード完了を待つ
            Promise.all(uploads).then(function () {
                console.log('アップロード完了');
            });
        });

        //ファイルのメタデータ
        var metadata = {
            contentType: "image/*",
        };
    </script>
</body>
</html>
